# History
setopt hist_ignore_all_dups hist_ignore_space share_history inc_append_history extended_history
setopt notify auto_cd interactive_comments

# Colors, prompt
autoload -Uz colors && colors
setopt prompt_subst

# Git
git_prompt() {
  git rev-parse --is-inside-work-tree >/dev/null 2>&1 || return 0

  local branch dirty
  branch=$(git symbolic-ref --quiet --short HEAD 2>/dev/null) \
    || branch=$(git rev-parse --short HEAD 2>/dev/null) \
    || return 0

  if [[ -n "$(git status --porcelain --ignore-submodules=dirty 2>/dev/null)" ]]; then
    dirty="*"
  else
    dirty=""
  fi

  printf ' %s%s %s%s' "%F{8}" "%f" "%F{13}${branch}%f" "%F{red}${dirty}%f"
}

# Prompt: user@host dir (newline) ❯
PROMPT='%F{green}%n%f@%F{blue}%m%f %F{yellow} %~%f$(git_prompt)
%F{8}❯%f '

export ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=8'

# Keybindings
bindkey -e
bindkey '^[[1;5C' forward-word
bindkey '^[[1;5D' backward-word

# Aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'

zstyle ':completion:*:cd:*' tag-order local-directories directory-stack path-directories
zstyle ':completion:*:cd:*' group-name ''
zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}' 'r:|[._-]=* r:|=*'
zstyle ':completion:*' verbose yes
zstyle ':completion:*' group-name ''

setopt auto_menu
zmodload zsh/complist 2>/dev/null || true

# Icons
alias ls='eza --icons=always --group-directories-first --classify'
alias ll='eza -alF --icons=always --group-directories-first --classify'
alias la='eza -A --icons=always --group-directories-first --classify'
